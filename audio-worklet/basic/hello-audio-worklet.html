<!DOCTYPE html>
<html>
<head>
  <title>Hello AudioWorklet! | Chrome WebAudio Samples</title>
  <link rel="stylesheet" href="../../resources/base.css">
  <script src="../lib/audio-worklet-base.js"></script>
</head>
<body>
  <a href="../index.html" class="link-small">&#171; AudioWorklet home</a>
  <h1>Demo: "Hello AudioWorklet!"</h1>
  <script>
    function runDemo() {
      const context = new AudioContext();
      let oscillator = new OscillatorNode(context);
      let bypasser = new AudioWorkletNode(context, 'bypasser');
      oscillator.connect(bypasser).connect(context.destination);
      oscillator.start();
    }
    
    window.addEventListener('load', () => {
      LibAudioWorklet.initializeReporter();
      if (LibAudioWorklet.isAvailable()) {
        LibAudioWorklet.reportMessage('info',
            'AudioWorklet is available. Start running demo...');
        window.audioWorklet.addModule('js/bypasser.js').then(runDemo);
      } else {
        LibAudioWorklet.reportMessage('error',
            'The browser does not support AudioWorklet yet.');
      }
    });
  </script>
</body>
</html>
